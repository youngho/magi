/*
    *
    * Wijmo Library 5.20171.300
    * http://wijmo.com/
    *
    * Copyright(c) GrapeCity, Inc.  All rights reserved.
    *
    * Licensed under the Wijmo Commercial License.
    * sales@wijmo.com
    * wijmo.com/products/wijmo-5/license/
    *
    */
var __extends=this&&this.__extends||function(){var n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}();define(["require","exports","wijmo/wijmo.grid","wijmo/wijmo.xlsx","wijmo/wijmo","wijmo/wijmo.grid.xlsx"],function(n,t,i,r,u,f){"use strict";function s(){var n,t;return(n=window.wijmo)&&(t=n.grid)&&t.detail}function h(){var n,t;return(n=window.wijmo)&&(t=n.grid)&&t.multirow}var e,o;Object.defineProperty(t,"__esModule",{value:!0});window.wijmo=window.wijmo||{};window.wijmo.grid=window.wijmo.grid||{};window.wijmo.grid.xlsx=f;e=function(){function n(){}return n.save=function(n,t,i){var r=this._saveFlexGridToWorkbook(n,t);return i&&r.save(i),r},n.saveAsync=function(n,t,i,r,u){var f=this._saveFlexGridToWorkbook(n,t);return f.saveAsync(i,r,u),f},n.load=function(n,t,i){var o=this,f,e;if(t instanceof Blob)f=new FileReader,f.onload=function(){var u=r.Workbook._base64EncArr(new Uint8Array(f.result)),t=new r.Workbook;t.load(u);u=null;n.deferUpdate(function(){o._loadToFlexGrid(n,t,i);t=null})},f.readAsArrayBuffer(t);else if(t instanceof r.Workbook)n.deferUpdate(function(){o._loadToFlexGrid(n,t,i);t=null});else{if(t instanceof ArrayBuffer)t=r.Workbook._base64EncArr(new Uint8Array(t));else if(!u.isString(t))throw'Invalid workbook.';e=new r.Workbook;e.load(t);t=null;n.deferUpdate(function(){o._loadToFlexGrid(n,e,i);e=null})}},n.loadAsync=function(n,t,i,f,e){var s=this,o,h;if(t instanceof Blob)o=new FileReader,o.onload=function(){var t=r.Workbook._base64EncArr(new Uint8Array(o.result)),u=new r.Workbook;u.loadAsync(t,function(r){t=null;u=null;n.deferUpdate(function(){s._loadToFlexGrid(n,r,i);f&&f(r);r=null})},e)},o.readAsArrayBuffer(t);else if(t instanceof r.Workbook)n.deferUpdate(function(){s._loadToFlexGrid(n,t,i);f&&f(t);t=null});else{if(t instanceof ArrayBuffer)t=r.Workbook._base64EncArr(new Uint8Array(t));else if(!u.isString(t))throw'Invalid workbook.';h=new r.Workbook;h.loadAsync(t,function(r){t=null;n.deferUpdate(function(){s._loadToFlexGrid(n,r,i);f&&f(r);r=null})},e)}},n._saveFlexGridToWorkbook=function(n,t){var rt=new r.Workbook,l=new r.WorkSheet,ot=new r.WorkbookStyle,ut=new r.WorkbookFrozenPane,st=t&&t.includeColumnHeaders!=null?t.includeColumnHeaders:!0,tt=t&&t.includeRowHeaders!=null?t.includeRowHeaders:!1,b=t&&t.includeCellStyles!=null?t.includeCellStyles:!0,at=t?t.activeWorksheet:null,v=t?t.includeColumns:null,g=t?t.formatItem:null,o,y,k,p,w,s,ht,f,h,e,ft,a,nt,ct,d,et=0,it=0,lt=0,c=0;if(ft=n.wj_sheetInfo,l.name=t?t.sheetName:'',l.visible=t?t.sheetVisible!==!1:!0,ht={borders:{top:{style:r.BorderStyle.Thin,color:'#D4D4D4'},left:{style:r.BorderStyle.Thin,color:'#D4D4D4'},bottom:{style:r.BorderStyle.Thin,color:'#D4D4D4'},right:{style:r.BorderStyle.Thin,color:'#D4D4D4'}}},ot._deserialize(ht),l.style=ot,s=[],!ft&&(b||g)&&(a=document.createElement('div'),a.style.visibility='hidden',a.setAttribute(i.FlexGrid._WJS_MEASURE,'true'),n.hostElement.appendChild(a)),tt){for(h=0,f=0;f<n.rowHeaders.rows.length;f++)if(!(n.rowHeaders.rows[f].renderSize<=0)){for(s[h]=[],e=0;e<n.rowHeaders.columns.length;e++)k=n._getBindingColumn(n.rowHeaders,f,n.rowHeaders.columns[e]),p=this._getColumnSetting(k,n.columnHeaders.columns.defaultSize),s[h][e]=p,h===0&&(w=new r.WorkbookColumn,w._deserialize(p),l._addWorkbookColumn(w,e));h++}c=e}if(st&&n.columnHeaders.rows.length>0){for(h=0,f=0;f<n.columnHeaders.rows.length;f++)if(!(n.columnHeaders.rows[f].renderSize<=0)){for(s[h]||(s[h]=[]),e=0;e<n.columnHeaders.columns.length;e++)k=n._getBindingColumn(n.columnHeaders,f,n.columnHeaders.columns[e]),p=this._getColumnSetting(k,n.columnHeaders.columns.defaultSize),s[h][c+e]=p,h===0&&(!v||v(k))&&(w=new r.WorkbookColumn,w._deserialize(p),l._addWorkbookColumn(w));c=0;o={};y=new r.WorkbookRow;tt&&(c=this._parseFlexGridRowToSheetRow(n.topLeftCells,o,f,0,s,b,a,!1,0,v));this._parseFlexGridRowToSheetRow(n.columnHeaders,o,f,c,s,b,a,!1,0,v);o.cells.length>0&&(y._deserialize(o),l._addWorkbookRow(y,h));h++}it=h}else for(s[0]||(s[0]=[]),e=0;e<n.columnHeaders.columns.length;e++)k=n._getBindingColumn(n.columnHeaders,0,n.columnHeaders.columns[e]),p=this._getColumnSetting(k,n.columnHeaders.columns.defaultSize),s[0][c+e]=p,(!v||v(k))&&(w=new r.WorkbookColumn,w._deserialize(p),l._addWorkbookColumn(w));for(f=0;f<n.cells.rows.length;f++)(c=0,o={},y=new r.WorkbookRow,nt=n.rows[f],nt instanceof i._NewRowTemplate)||(d=nt instanceof i.GroupRow,d&&(ct=u.tryCast(nt,i.GroupRow),et=ct.level+1),tt&&(c=this._parseFlexGridRowToSheetRow(n.rowHeaders,o,f,0,s,b,a,d,et,v,g)),this._parseFlexGridRowToSheetRow(n.cells,o,f,c,s,b,a,d,et,v,g),o.cells.length>0&&(y._deserialize(o),l._addWorkbookRow(y,it+f)));for(lt=n.cells.rows.length,f=0;f<n.columnFooters.rows.length;f++)c=0,o={},y=new r.WorkbookRow,nt=n.columnFooters.rows[f],d=nt instanceof i.GroupRow,tt&&(c=this._parseFlexGridRowToSheetRow(n.rowHeaders,o,f,0,s,b,a,d,0,v,g)),this._parseFlexGridRowToSheetRow(n.columnFooters,o,f,c,s,b,a,d,0,v,g),o.cells.length>0&&(y._deserialize(o),l._addWorkbookRow(y,it+lt+f));return ut.rows=st?n.frozenRows+it:n.frozenRows,ut.columns=tt?n.frozenColumns+c:n.frozenColumns,l.frozenPane=ut,rt._addWorkSheet(l),!ft&&(b||g)&&n.hostElement.removeChild(a),rt.activeWorksheet=at,rt},n._loadToFlexGrid=function(n,t,f){var fi=f&&f.includeColumnHeaders!=null?f.includeColumnHeaders:!0,k=f&&f.includeColumnHeaders!=null?f.includeColumnHeaders:!0,wt=f&&f.sheetIndex!=null&&!isNaN(f.sheetIndex)?f.sheetIndex:0,gt=f?f.sheetName:null,ei=f?f.sheetVisible:!0,ni=n.wj_sheetInfo!=null,o=0,h=0,b,ut,p,ft,g,d,et,bt,it,ti,s,l,ii,nt,ot,c,st,ht,ri,kt,v,ct,tt,w,a,e,y,dt,lt,at,ui,rt,vt=!1,yt={},pt;if(n.itemsSource=null,n.columns.clear(),n.rows.clear(),n.frozenColumns=0,n.frozenRows=0,y={},dt={},h=0,ft=[],lt=[],wt<0||wt>=t.sheets.length)throw'The sheet index option is out of the sheet range of current workbook.';if(gt!=null)for(b=0;b<t.sheets.length;b++)if(gt===t.sheets[b].name){l=t.sheets[b];break}if(l=l||t.sheets[wt],l.rows!=null){for(fi&&(h=1,l.rows.length<=1&&(k=!1,h=0),bt=l.rows[0]),nt=this._getColumnCount(l.rows),ii=this._getRowCount(l.rows,nt),ri=l.summaryBelow,p=l.columns,o=0;o<nt;o++)n.columns.push(new i.Column),!p[o]||(isNaN(+p[o].width)||(n.columns[o].width=+p[o].width),p[o].visible||p[o].visible==undefined||(n.columns[o].visible=!!p[o].visible),p[o].style&&!!p[o].style.wordWrap&&(n.columns[o].wordWrap=p[o].style.wordWrap));for(;h<ii;h++){if(ot=!1,pt=!0,s=l.rows[h],s)for(st=h+1;st<l.rows.length;)if(ht=l.rows[st],ht){(isNaN(s.groupLevel)&&!isNaN(ht.groupLevel)||!isNaN(s.groupLevel)&&s.groupLevel<ht.groupLevel)&&(ot=!0);break}else st++;for(ot&&!ri?(v&&(v.isCollapsed=vt),v=new i.GroupRow,v.isReadOnly=!1,vt=s.collapsed==null?!1:s.collapsed,v.level=isNaN(s.groupLevel)?0:s.groupLevel,yt[v.level]=vt,this._checkParentCollapsed(yt,v.level)&&v._setFlag(i.RowColFlags.ParentCollapsed,!0),n.rows.push(v)):(kt=new i.Row,s&&this._checkParentCollapsed(yt,s.groupLevel)&&kt._setFlag(i.RowColFlags.ParentCollapsed,!0),n.rows.push(kt)),!s||!s.height||isNaN(s.height)||(n.rows[k?h-1:h].height=s.height),o=0;o<nt;o++)if(s){if(c=s.cells[o],w=c?c.formula:undefined,w&&w[0]!=='='&&(w='='+w),w=w?this._parseToFlexSheetFormula(w):undefined,n.setCellData(k?h-1:h,o,w&&ni?w:this._getItemValue(c)),ot||this._setColumn(ft,o,c),a=h*nt+o,e=c?c.style:undefined,at=r.Workbook._parseExcelFormat(c),e){if(pt=pt&&!!e.wordWrap,ui=this._getItemType(c),e.hAlign)rt=r.Workbook._parseHAlignToString(u.asEnum(e.hAlign,r.HAlign));else switch(ui){case u.DataType.Number:rt='right';break;case u.DataType.Boolean:rt='center';break;default:rt=at&&at.search(/[n,c,p]/i)===0?'right':'left'}y[a]={fontWeight:e.font&&e.font.bold?'bold':'none',fontStyle:e.font&&e.font.italic?'italic':'none',textDecoration:e.font&&e.font.underline?'underline':'none',textAlign:rt,fontFamily:e.font&&e.font.family?e.font.family:'',fontSize:e.font&&e.font.size?e.font.size+'px':'',color:e.font&&e.font.color?e.font.color:'',backgroundColor:e.fill&&e.fill.color?e.fill.color:'',whiteSpace:e.wordWrap?'pre-wrap':'normal',format:at};e.borders&&(e.borders.left&&(this._parseBorderStyle(e.borders.left.style,'Left',y[a]),y[a].borderLeftColor=e.borders.left.color),e.borders.right&&(this._parseBorderStyle(e.borders.right.style,'Right',y[a]),y[a].borderRightColor=e.borders.right.color),e.borders.top&&(this._parseBorderStyle(e.borders.top.style,'Top',y[a]),y[a].borderTopColor=e.borders.top.color),e.borders.bottom&&(this._parseBorderStyle(e.borders.bottom.style,'Bottom',y[a]),y[a].borderBottomColor=e.borders.bottom.color));e.font&&lt.indexOf(e.font.family)===-1&&lt.push(e.font.family)}if(c&&u.isNumber(c.rowSpan)&&c.rowSpan>0&&u.isNumber(c.colSpan)&&c.colSpan>0&&(c.rowSpan>1||c.colSpan>1))for(b=h;b<h+c.rowSpan;b++)for(ut=o;ut<o+c.colSpan;ut++)a=b*nt+ut,dt[a]=new i.CellRange(h,o,h+c.rowSpan-1,o+c.colSpan-1)}else n.setCellData(k?h-1:h,o,''),this._setColumn(ft,o,undefined);s&&(this._checkParentCollapsed(yt,s.groupLevel)||s.visible||s.visible==undefined||(n.rows[k?h-1:h].visible=s.visible),n.rows[k?h-1:h].wordWrap=!!s.style&&!!s.style.wordWrap||pt)}for(v&&(v.isCollapsed=vt),l.frozenPane&&(ct=l.frozenPane.columns,u.isNumber(ct)&&!isNaN(ct)&&(n.frozenColumns=ct),tt=l.frozenPane.rows,u.isNumber(tt)&&!isNaN(tt)&&(n.frozenRows=k&&tt>0?tt-1:tt)),o=0;o<n.columnHeaders.columns.length;o++)g=ft[o],d=n.columns[o],d.isRequired=!1,k?(it=bt?bt.cells[o]:undefined,it&&it.value?(ti=r.Workbook._parseExcelFormat(it),et=u.Globalize.format(it.value,ti)):et=this._numAlpha(o)):et=this._numAlpha(o),d.header=et,g&&(g.dataType===u.DataType.Boolean&&(d.dataType=g.dataType),d.format=g.format,d.align=g.hAlign,d.wordWrap=d.wordWrap||g.wordWrap);ni&&(n.wj_sheetInfo.name=l.name,n.wj_sheetInfo.visible=ei===!0?!0:l.visible!==!1,n.wj_sheetInfo.styledCells=y,n.wj_sheetInfo.mergedRanges=dt,n.wj_sheetInfo.fonts=lt)}},n._parseFlexGridRowToSheetRow=function(n,t,f,e,c,l,a,v,y,p,w){var it,g,ft,b,st,k,d,tt,rt,at,ht,kt,et,ut,yt,pt,vt,nt,gt=!1,wt,ct,ni,bt,dt,ot,lt,ti;for(it=n.grid,vt=it.wj_sheetInfo,g=n.rows[f],ni=g.recordIndex!=null?g.recordIndex:0,t.cells||(t.cells=[]),t.visible=g.isVisible,t.height=g.renderHeight||n.rows.defaultSize,t.groupLevel=v?y-1:y,v&&(t.collapsed=g.isCollapsed),g.wordWrap&&(t.style={wordWrap:g.wordWrap}),(g.constructor===i.Row||g.constructor===i._NewRowTemplate||s()&&g.constructor===s().DetailRow||h()&&g.constructor===h()._MultiRow)&&(gt=!0),b=0;b<n.columns.length;b++)if(st=null,pt=1,yt=1,ct=!1,et=null,lt=null,wt=it._getBindingColumn(n,f,n.columns[b]),ut=null,vt&&n===it.cells?(kt=f*n.columns.length+b,vt.mergedRanges&&(ut=vt.mergedRanges[kt]),vt.styledCells&&(et=vt.styledCells[kt])):l&&(ot=a.cloneNode(),a.parentElement.appendChild(ot),l&&(et=this._getCellStyle(n,ot,f,b)||{})),ut||(ut=it.getMergedRange(n,f,b,!1)),ut?f===ut.topRow&&b===ut.leftCol&&(yt=ut.bottomRow-ut.topRow+1,pt=this._getColSpan(n,ut,p),ct=!0):ct=!0,!p||p(wt)){if(ft=c[ni][b+e],gt||v?(d=ct?n.getCellData(f,b,!0):null,tt=ct?n.getCellData(f,b,!1):null,at=!1,d&&u.isString(d)&&d.length>1&&d[0]==='='&&(at=!0),nt=u.isDate(tt),et&&et.format?(st=et.format,k=r.Workbook._parseCellFormat(et.format,nt)):ft&&ft.style&&ft.style.format?(st=wt.format,k=ft.style.format):k=null,k||(nt?k='m/d/yyyy':u.isNumber(tt)&&!wt.dataMap?k=u.isInt(tt)?'#,##0':'#,##0.00':at?(ht=d.toLowerCase(),ht==='=now()'?(k='m/d/yyyy h:mm',nt=!0):ht==='=today()'||ht.substring(0,ht.indexOf('('))==='=date'?(k='m/d/yyyy',nt=!0):ht.substring(0,ht.indexOf('('))==='=time'&&(k='h:mm AM/PM',nt=!0)):k='General')):(d=ct?it.columnHeaders.getCellData(0,b,!0):null,k='General'),lt=this._parseCellStyle(et)||{},n===it.cells&&v&&g.hasChildren&&b===it.columns.firstVisibleIndex){if(d?rt=d:ct&&(rt=g.getGroupHeader().replace(/<\/?\w+>/g,'')),rt==null&&!et)continue;nt=u.isDate(rt);!nt&&st&&st.toLowerCase()==='d'&&u.isInt(rt)&&(k='0');rt=typeof rt=='string'?r.Workbook._unescapeXML(rt):rt;bt={value:rt,isDate:nt,formula:at?this._parseToExcelFormula(d,nt):null,colSpan:pt,rowSpan:yt,style:this._extend(lt,{format:k,font:{bold:!0},hAlign:r.HAlign.Left,indent:y-1})}}else d=typeof d=='string'?r.Workbook._unescapeXML(d):d,tt=typeof tt=='string'?r.Workbook._unescapeXML(tt):tt,!nt&&st&&st.toLowerCase()==='d'&&u.isInt(tt)&&(k='0'),ti=lt&&lt.hAlign?lt.hAlign:ft&&ft.style&&ft.style.hAlign!=null?u.asEnum(ft.style.hAlign,r.HAlign,!0):u.isDate(tt)?r.HAlign.Left:r.HAlign.General,bt={value:at?undefined:k==='General'?d:tt,isDate:nt,formula:at?this._parseToExcelFormula(d,nt):null,colSpan:b<it.columns.firstVisibleIndex?1:pt,rowSpan:yt,style:this._extend(lt,{format:k,hAlign:ti,vAlign:yt>1?n===it.cells?r.VAlign.Top:r.VAlign.Center:null})};w&&(dt=new o(n,new i.CellRange(f,b),ot,a,bt),w(dt),ot=dt.cell);ot&&(ot.parentElement.removeChild(ot),ot=null);t.cells.push(bt)}return e+b},n._parseCellStyle=function(n){var t,u,e,i,f;return n==null?null:(t=n.fontSize,t=t?+t.substring(0,t.indexOf('px')):null,isNaN(t)&&(t=null),u=n.fontWeight,u=u==='bold'||+u>=700,e=n.fontStyle==='italic',i=n.textDecorationStyle,i==null&&(i=n.textDecoration),i=i==='underline',f=n.whiteSpace,f=f?f.indexOf('pre')>-1?!0:!1:!1,{font:{bold:u,italic:e,underline:i,family:this._parseToExcelFontFamily(n.fontFamily),size:t,color:n.color},fill:{color:n.backgroundColor},borders:this._parseBorder(n),hAlign:r.Workbook._parseStringToHAlign(n.textAlign),wordWrap:f})},n._parseBorder=function(n){var t={};return t.left=this._parseEgdeBorder(n,'Left'),t.right=this._parseEgdeBorder(n,'Right'),t.top=this._parseEgdeBorder(n,'Top'),t.bottom=this._parseEgdeBorder(n,'Bottom'),t},n._parseEgdeBorder=function(n,t){var i,u=n['border'+t+'Style'];if(u&&u!=='none'&&u!=='hidden'){i={};u=u.toLowerCase();switch(u){case'dotted':i.style=r.BorderStyle.Dotted;break;case'dashed':i.style=r.BorderStyle.Dashed;break;case'double':i.style=r.BorderStyle.Double;break;default:i.style=r.BorderStyle.Thin}i.color=n['border'+t+'Color']}return i},n._parseBorderStyle=function(n,t,i){var u='border'+t+'Style',f='border'+t+'Width';switch(n){case r.BorderStyle.Dotted:case r.BorderStyle.Hair:i[u]='dotted';i[f]='1px';break;case r.BorderStyle.Dashed:case r.BorderStyle.ThinDashDotDotted:case r.BorderStyle.ThinDashDotted:i[u]='dashed';i[f]='1px';break;case r.BorderStyle.MediumDashed:case r.BorderStyle.MediumDashDotDotted:case r.BorderStyle.MediumDashDotted:case r.BorderStyle.SlantedMediumDashDotted:i[u]='dashed';i[f]='2px';break;case r.BorderStyle.Double:i[u]='double';i[f]='3px';break;case r.BorderStyle.Medium:i[u]='solid';i[f]='2px';break;default:i[u]='solid';i[f]='1px'}},n._parseToExcelFontFamily=function(n){var t;return n&&(t=n.split(','),t&&t.length>0&&(n=t[0].replace(/\"|\'/g,''))),n},n._parseToExcelFormula=function(n,t){var f=n.substring(1,n.indexOf('(')).toLowerCase(),i,u;switch(f){case'ceiling':case'floor':n=n.substring(0,n.lastIndexOf(')'))+', 1)';break;case'text':u=n.search(/\,\s*\"/);i=n.substring(u,n.lastIndexOf('\"'));i=r.Workbook._parseCellFormat(i.substring(i.lastIndexOf('\"')+1),t);n=n.substring(0,u)+', \"'+i+'\")'}return n},n._parseToFlexSheetFormula=function(n){var f=n.substring(1).match(/\W+(\w+)\(/),i,e,o,s,t,u;e=f&&f.length===2?f[1]:n.substring(1,n.indexOf('('));o=n.indexOf(e);switch(e.toLowerCase()){case'ceiling':case'floor':n=n.substring(0,n.lastIndexOf(','))+')';break;case'text':i=n.substring(o);t=i.substring(i.indexOf('\"'),i.lastIndexOf('\"'));t=t.substring(t.lastIndexOf('\"')+1);s=t.indexOf('0')>-1?0:'';u=r.Workbook._parseExcelFormat({value:s,style:{format:t}});u=u.replace(/m+/g,function(n){return n.toUpperCase()}).replace(/Y+/g,function(n){return n.toLowerCase()}).replace(/M+:?|:?M+/gi,function(n){return n.indexOf(':')>-1?n.toLowerCase():n});n=n.substring(0,o)+i.substring(0,i.indexOf('\"')+1)+u+n.substring(n.indexOf(t)+t.length)}return n},n._getColumnSetting=function(n,t){var i=n.renderWidth;return i=i||t,{autoWidth:!0,width:i,visible:n.visible,style:{format:n.format?r.Workbook._parseCellFormat(n.format,n.dataType===u.DataType.Date):'',hAlign:r.Workbook._parseStringToHAlign(this._toExcelHAlign(n.getAlignment())),wordWrap:n.wordWrap}}},n._toExcelHAlign=function(n){return(n=n?n.trim().toLowerCase():n,!n)?n:n.indexOf('center')>-1?'center':n.indexOf('right')>-1||n.indexOf('end')>-1?'right':n.indexOf('justify')>-1?'justify':'left'},n._getColumnCount=function(n){for(var f=0,t=0,i,r=0;r<n.length;r++)i=n[r]&&n[r].cells?n[r].cells:[],i&&i.length>0&&(t=i.length,u.isInt(i[t-1].colSpan)&&i[t-1].colSpan>1&&(t=t+i[t-1].colSpan-1),t>f&&(f=t));return f},n._getRowCount=function(n,t){for(var f=n.length,r=f-1,o=0,e,s,i;o<t;o++)n:for(;r>=0;r--)if(e=n[r],s=e&&e.cells?e.cells:[],i=s[o],i&&(i.value!=null&&i.value!==''||u.isInt(i.rowSpan)&&i.rowSpan>1)){u.isInt(i.rowSpan)&&i.rowSpan>1&&r+i.rowSpan>f&&(f=r+i.rowSpan);break n}return f},n._numAlpha=function(n){var t=Math.floor(n/26)-1;return(t>-1?this._numAlpha(t):'')+String.fromCharCode(65+n%26)},n._getItemType=function(n){return n===undefined||n===null||n.value===undefined||n.value===null||isNaN(n.value)?undefined:u.getType(n.value)},n._setColumn=function(n,t,i){var e,o,s,f=n[t];f?(e=this._getItemType(i),f.dataType!==e&&f.dataType===u.DataType.Boolean&&e!==u.DataType.Boolean&&(f.dataType=e),i&&i.value!=null&&i.value!==''&&(o=r.Workbook._parseExcelFormat(i),o&&f.format!==o&&o!=='General'&&(f.format=o)),i&&i.style&&(i.style.hAlign&&(s=r.Workbook._parseHAlignToString(u.asEnum(i.style.hAlign,r.HAlign))),f.wordWrap=f.wordWrap&&!!i.style.wordWrap),s||e!==u.DataType.Number||(s='right'),f.hAlign=s):n[t]={dataType:this._getItemType(i),format:r.Workbook._parseExcelFormat(i),hAlign:'',wordWrap:!0}},n._getItemValue=function(n){if(n===undefined||n===null||n.value===undefined||n.value===null)return undefined;var t=n.value;return u.isNumber(t)&&isNaN(t)?'':t instanceof Date&&isNaN(t.getTime())?'':t},n._getCellStyle=function(n,t,i,r){try{n.grid.cellFactory.updateCell(n,i,r,t);t.className=t.className.replace('wj-state-selected','');t.className=t.className.replace('wj-state-multi-selected','')}catch(u){return null}return window.getComputedStyle(t)},n._extend=function(n,t){var i,r;for(i in t)r=t[i],u.isObject(r)&&n[i]?u.copy(n[i],r):n[i]=r;return n},n._checkParentCollapsed=function(n,t){var i=!1;return Object.keys(n).forEach(function(r){n[r]===!0&&i===!1&&!isNaN(t)&&+r<t&&(i=!0)}),i},n._getColSpan=function(n,t,i){for(var u=0,r=t.leftCol;r<=t.rightCol;r++)(!i||i(n.columns[r]))&&u++;return u},n}();t.FlexGridXlsxConverter=e;o=function(n){function t(t,i,r,u,f){var e=n.call(this,t,i)||this;return e._cell=r,e._patternCell=u,e._xlsxCell=f,e}return __extends(t,n),Object.defineProperty(t.prototype,"cell",{get:function(){return this._cell},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"xlsxCell",{get:function(){return this._xlsxCell},set:function(n){this._xlsxCell=n},enumerable:!0,configurable:!0}),t.prototype.getFormattedCell=function(){return this._cell||(this._cell=this._patternCell.cloneNode(),this._patternCell.parentElement.appendChild(this._cell),e._getCellStyle(this.panel,this._cell,this.range.row,this.range.col)),this._cell},t}(i.CellRangeEventArgs);t.XlsxFormatItemEventArgs=o})