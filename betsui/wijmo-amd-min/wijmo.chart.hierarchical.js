/*
    *
    * Wijmo Library 5.20171.300
    * http://wijmo.com/
    *
    * Copyright(c) GrapeCity, Inc.  All rights reserved.
    *
    * Licensed under the Wijmo Commercial License.
    * sales@wijmo.com
    * wijmo.com/products/wijmo-5/license/
    *
    */
var __extends=this&&this.__extends||function(){var n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}();define(["require","exports","wijmo/wijmo.chart","wijmo/wijmo","wijmo/wijmo.chart.hierarchical"],function(n,t,i,r,u){"use strict";var l,f,o,h,c,s,e;Object.defineProperty(t,"__esModule",{value:!0});window.wijmo=window.wijmo||{};window.wijmo.chart=window.wijmo.chart||{};window.wijmo.chart.hierarchical=u;l=function(n){function t(t,i){var r=n.call(this,t,i)||this;return r._processedData=[],r._legendLabels=[],r._level=1,r._sliceIndex=0,r._processedItem=[],r._selectionIndex=0,r.applyTemplate('wj-sunburst',null,null),r}return __extends(t,n),Object.defineProperty(t.prototype,"bindingName",{get:function(){return this._bindName},set:function(n){n!=this._bindName&&(r.assert(n==null||r.isArray(n)||r.isString(n),'bindingName should be an array or a string.'),this._bindName=n,this._bindChart())},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"childItemsPath",{get:function(){return this._childItemsPath},set:function(n){n!=this._childItemsPath&&(r.assert(n==null||r.isArray(n)||r.isString(n),'childItemsPath should be an array or a string.'),this._childItemsPath=n,this._bindChart())},enumerable:!0,configurable:!0}),t.prototype._initData=function(){n.prototype._initData.call(this);this._processedData=[];this._level=1;this._legendLabels=[];this._processedItem=[]},t.prototype._performBind=function(){var t=this,n;this._initData();this._cv&&(n=this._cv.items,this._cv.groups&&this._cv.groups.length?this._processedData=e.parseDataToHierarchical(this._cv,this.binding,this.bindingName,this.childItemsPath):n&&(this._processedData=e.parseDataToHierarchical(n,this.binding,this.bindingName,this.childItemsPath)),this._processedData&&this._processedData.length&&(this._sum=this._calculateValueAndLevel(this._processedData,1),this._processedData.forEach(function(n){t._legendLabels.push(n.name)})))},t.prototype._calculateValueAndLevel=function(n,t){var i=this,r=0,u=this._values,f=this._labels;return this._level<t&&(this._level=t),n.forEach(function(n){var e;n.items?(e=i._calculateValueAndLevel(n.items,t+1),n.value=e,u.push(e),f.push(n.name)):(e=i._getBindData(n,u,f,'value','name'),n.value=e);r+=e}),r},t.prototype._renderPie=function(n,t,i,r,u){var f=this._getCenter();this._sliceIndex=0;this._renderHierarchicalSlices(n,f.x,f.y,this._processedData,this._sum,t,i,r,2*Math.PI,u,1)},t.prototype._renderHierarchicalSlices=function(n,t,i,r,u,f,e,o,s,h,c){var rt=r.length,a=o,g=this.reversed==!0,nt,tt,d,l,y,p,it,w,b,k,v;for(d=(f-e)/this._level,nt=f-(this._level-c)*d,tt=e+(c-1)*d,v=0;v<rt;v++)w=t,b=i,it=n.startGroup('slice-level'+c),c===1&&(n.fill=this._getColorLight(v),n.stroke=this._getColor(v)),y=r[v],p=Math.abs(y.value),l=Math.abs(p-u)<1e-10?s:s*p/u,k=g?a-.5*l:a+.5*l,h>0&&l<s&&(w+=h*Math.cos(k),b+=h*Math.sin(k)),y.items&&this._renderHierarchicalSlices(n,w,b,y.items,p,f,e,a,l,0,c+1),this._renderSlice(n,w,b,k,this._sliceIndex,nt,tt,a,l,s),this._processedItem.push(y.item),this._sliceIndex++,g?a-=l:a+=l,n.endGroup(),this._pels.push(it)},t.prototype._getLabelsForLegend=function(){return this._legendLabels||[]},t.prototype._highlightCurrent=function(){this.selectionMode!=i.SelectionMode.None&&this._highlight(!0,this._selectionIndex)},t.prototype.hitTest=function(t,r){var u=n.prototype.hitTest.call(this,t,r),o=this._toControl(t,r);if(i.FlexChart._contains(this._rectChart,o)){var f=u.pointIndex,s=this._processedItem[f],e=new i._DataPoint(null,f,null,null);e.item=s;u._setDataPoint(e)}return u},t}(i.FlexPie);t.Sunburst=l,function(n){n[n.Squarified=0]="Squarified";n[n.Horizontal=1]="Horizontal";n[n.Vertical=2]="Vertical"}(f=t.TreeMapType||(t.TreeMapType={}));o=function(n){function t(t,r){var u=n.call(this,t,null,!0)||this;return u._values=[],u._labels=[],u._areas=[],u._sum=0,u._keywords=new i._KeyWords,u._processedData=[],u._depth=1,u._itemIndex=0,u._processedItem=[],u._maxDepth=-1,u._tmItems=[],u._colRowLens=[],u._defPalette=[{titleColor:'#033884',maxColor:'#1450a7',minColor:'#83b3f9'},{titleColor:'#a83100',maxColor:'#dc4a0d',minColor:'#ffb190'},{titleColor:'#006658',maxColor:'#008d7a',minColor:'#7deddf'},{titleColor:'#a10046',maxColor:'#df0061',minColor:'#ff8cbe'},{titleColor:'#784d08',maxColor:'#99681a',minColor:'#efc989'},{titleColor:'#54156f',maxColor:'#722a90',minColor:'#cf95e7'},{titleColor:'#998605',maxColor:'#c2ac19',minColor:'#ffef8b'},{titleColor:'#9a0005',maxColor:'#c80c14',minColor:'#ff888d'}],u.applyTemplate('wj-control wj-flexchart wj-treemap',null,null),u._currentRenderEngine=new i._SvgRenderEngine(u.hostElement),u._legend=new i.Legend(u),u._legend.position=i.Position.None,u._tooltip=new i.ChartTooltip,u._tooltip.content='<b>{name}</b><br/>{value}',u._tooltip.showDelay=0,u._lbl=new i.DataLabel,u._lbl._chart=u,u.hostElement.addEventListener('mousemove',function(n){u.isTouching||u._toogleTooltip(n)}),u.hostElement.addEventListener('click',function(n){var e=!0,t,r,f;u.maxDepth>0&&(t=u.hitTest(n),r=i.FlexChart._SELECTION_THRESHOLD,u.tooltip&&u.tooltip.threshold&&(r=u.tooltip.threshold),t.distance<=r&&t.pointIndex>=-1&&t.pointIndex<u._areas.length&&(f=u._areas[t.pointIndex],u._currentItem!=f.item&&(u._currentItem=f.item,u._refreshChart(),e=!1)));e&&u.isTouching&&u._toogleTooltip(n)}),u.hostElement.addEventListener('contextmenu',function(n){if(u.maxDepth>0){var r=u.hitTest(n),t=i.FlexChart._SELECTION_THRESHOLD;u.tooltip&&u.tooltip.threshold&&(t=u.tooltip.threshold);r.distance<=t&&u._rollUp()}return n.preventDefault(),!1}),u.hostElement.addEventListener('mouseleave',function(){u._hideToolTip()}),u.initialize(r),u.refresh(),u}return __extends(t,n),t.prototype._rollUp=function(){this._currentItem=this._currentItem&&this._currentItem.parent?this._currentItem.parent:null;this._refreshChart()},t.prototype._toogleTooltip=function(n){var i=this._tooltip,f=i.content,t,u;f&&(t=this.hitTest(n),t.distance<=i.threshold?(u=this._getLabelContent(t,this.tooltip.content),this._showToolTip(u,new r.Rect(n.clientX,n.clientY,5,5))):this._hideToolTip())},Object.defineProperty(t.prototype,"tooltip",{get:function(){return this._tooltip},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"binding",{get:function(){return this._binding},set:function(n){n!=this._binding&&(this._binding=r.asString(n,!0),this._bindChart())},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"type",{get:function(){return this._type==null?f.Squarified:this._type},set:function(n){n!=this._type&&(this._type=r.asEnum(n,f),this.invalidate())},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"bindingName",{get:function(){return this._bindingName},set:function(n){n!=this._bindingName&&(r.assert(n==null||r.isArray(n)||r.isString(n),'bindingName should be an array or a string.'),this._bindingName=n,this._bindChart())},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"dataLabel",{get:function(){return this._lbl},set:function(n){n!=this._lbl&&(this._lbl=n,this._lbl&&(this._lbl._chart=this))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"childItemsPath",{get:function(){return this._childItemsPath},set:function(n){n!=this._childItemsPath&&(r.assert(n==null||r.isArray(n)||r.isString(n),'childItemsPath should be an array or a string.'),this._childItemsPath=n,this._bindChart())},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"maxDepth",{get:function(){return this._maxDepth},set:function(n){n!=this._maxDepth&&(this._maxDepth=r.asNumber(n,!0),this.invalidate())},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"palette",{get:function(){return this._palette},set:function(n){n!=this._palette&&(this._palette=r.asArray(n),this._tmItems&&this._tmItems.length>0&&this._calculateColorForItems(this._tmItems),this.invalidate())},enumerable:!0,configurable:!0}),t.prototype._initData=function(){this._sum=0;this._tmItems=[];this._currentItem=null;this._values=[];this._labels=[];this._processedData=[];this._depth=1;this._processedItem=[]},t.prototype._performBind=function(){var n;this._initData();this._cv&&(n=this._cv.items,this._cv.groups&&this._cv.groups.length?this._processedData=e.parseDataToHierarchical(this._cv,this.binding,this.bindingName,this.childItemsPath):n&&(this._processedData=e.parseDataToHierarchical(n,this.binding,this.bindingName,this.childItemsPath)),this._processedData&&this._processedData.length&&(this._sum=this._calculateValueAndDepth(this._processedData,1),this._sortData(this._processedData),this._values=[],this._getTMItemsAndLabelsAndValues(this._processedData,this._tmItems,1,null),this._calculateColorForItems(this._tmItems)))},t.prototype._sortData=function(n){var t=this;n.forEach(function(n){n.items&&t._sortData(n.items)});n.sort(function(n,t){return t.value-n.value})},t.prototype._getTMItemsAndLabelsAndValues=function(n,t,i,r){var u=this;n&&n.length>0&&n.forEach(function(n){var f=new h,e;f.items=[];f.parent=r;f.depth=i;n.items&&u._getTMItemsAndLabelsAndValues(n.items,f.items,i+1,f);e=n.name?n.name:n.value.toString();f.label=e;f.value=n.value;r!=null&&(n.value>r.maxValue&&(r.maxValue=n.value),n.value<r.minValue&&(r.minValue=n.value));t.push(f);u._labels.push(e);u._values.push(n.value)})},t.prototype._calculateColorForItems=function(n,t,i){var u=this,f=i;n.forEach(function(n,i){var s=t,e,o,l,h,a;n.depth===1&&(s=u._getColor(i));n.palette=s;e=n.palette;r.isString(e)?(o=e,l=u._getLightColor(o),n.titleFill=o,n.titleStroke=o,n.fill=l,n.stroke=o):e.maxColor&&e.minColor&&e.titleColor&&(n.titleFill=e.titleColor,n.titleStroke=e.titleColor,n.parent==null?(n.fill=e.maxColor,n.stroke=e.maxColor):(f==null&&(f=new c(e.minColor,n.minValue,e.maxColor,n.maxValue)),h=f._calculateColorByVal(n.value,!0).toString(),n.fill=h,n.stroke=h));n.items&&n.items.length>0&&(a=new c(e.minColor,n.minValue,e.maxColor,n.maxValue),u._calculateColorForItems(n.items,s,a))})},t.prototype._getBindData=function(n,t,i){var f,u=0;return i&&(f=n[i]),u=0,r.isNumber(f)?u=r.asNumber(f):f&&(u=parseFloat(f.toString())),!isNaN(u)&&isFinite(u)?t.push(u):(u=0,t.push(u)),u},t.prototype._calculateValueAndDepth=function(n,t){var i=this,r=0,u=this._values;return this._depth<t&&(this._depth=t),n.forEach(function(n){var f;n.items?(f=i._calculateValueAndDepth(n.items,t+1),n.value=f,u.push(f)):(f=i._getBindData(n,u,'value'),n.value=f);r+=f}),r},t.prototype._render=function(n){var k=this.hostElement,a=this._getHostSize(),f=a.width,e=a.height,v,y,p,w,l,o,h,u,c,s,b;if((f==0||isNaN(f))&&(f=i.FlexChart._WIDTH),(e==0||isNaN(e))&&(e=i.FlexChart._HEIGHT),w=new r.Size(f,e),n.beginRender(),f>0&&e>0){this._areas=[];n.setViewportSize(f,e);l=this.legend;u=new r.Rect(0,0,f,e);this._rectChart=u.clone();n.startGroup(i.FlexChart._CSS_HEADER);u=this._drawTitle(n,u,this.header,this.headerStyle,!1);n.endGroup();n.startGroup(i.FlexChart._CSS_FOOTER);u=this._drawTitle(n,u,this.footer,this.footerStyle,!0);n.endGroup();this.onRendering(new i.RenderEventArgs(n));f=u.width;e=u.height;c=l._getPosition(f,e);o=l._getDesiredSize(n,c,f,e);switch(c){case i.Position.Right:f-=o.width;h=new r.Point(f,u.top+.5*(e-o.height));break;case i.Position.Left:u.left+=o.width;f-=o.width;h=new r.Point(0,u.top+.5*(e-o.height));break;case i.Position.Top:e-=o.height;h=new r.Point(.5*(f-o.width),u.top);u.top+=o.height;break;case i.Position.Bottom:e-=o.height;h=new r.Point(.5*(f-o.width),u.top+e)}u.width=f;u.height=e;this._tmGroup=n.startGroup(null,null,!0);s=this._parseMargin(this.plotMargin);b=this.dataLabel;isNaN(s.left)&&(s.left=t._MARGIN);isNaN(s.right)&&(s.right=t._MARGIN);isNaN(s.top)&&(s.top=t._MARGIN);isNaN(s.bottom)&&(s.bottom=t._MARGIN);u.top+=s.top;e=u.height-(s.top+s.bottom);u.height=e>0?e:24;u.left+=s.left;f=u.width-(s.left+s.right);u.width=f>0?f:24;this._plotRect=u;v=this._currentItem?[this._currentItem]:this._tmItems;y=this._currentItem==null||this.maxDepth<1?this.maxDepth:this._currentItem&&this._currentItem.items&&this._currentItem.items.length&&this.maxDepth>1?this.maxDepth:this.maxDepth+1;p=this._currentItem?this._currentItem.value:this._sum;this._renderTreeMap(n,u,this._tmGroup,v,p,y);n.endGroup();o?(this._legendHost=n.startGroup(i.FlexChart._CSS_LEGEND),this._rectLegend=new r.Rect(h.x,h.y,o.width,o.height),n.textFill=i.FlexChart._FG,this.legend._render(n,h,c,o.width,o.height),n.textFill=null,n.endGroup()):(this._legendHost=null,this._rectLegend=null);this.dataLabel.content&&this.dataLabel.position!=i.LabelPosition.None&&this._renderLabels(n);this.onRendered(new i.RenderEventArgs(n))}n.endRender()},t.prototype._renderTreeMap=function(n,t,i,r,u,f){u>0&&(this._itemIndex=0,this._resetItemRects(this._tmItems),this._calculateItemRects(t,r,u,1,f),this._renderHierarchicalTreeMapItems(n,i,t,this._tmItems,u,1,f))},t.prototype._resetItemRects=function(n){var t=this;n.forEach(function(n){n.rect=new r.Rect(0,0,0,0);n.isTitle=!1;n.type=t.type;n.items&&n.items.length&&t._resetItemRects(n.items)})},t.prototype._calculateItemRects=function(n,t,i,r,u){var e=this,o=this.type;switch(o){case f.Horizontal:s.horizontal(t,n,i);break;case f.Vertical:s.vertical(t,n,i);break;case f.Squarified:s.squarified(t,n,i)}t.forEach(function(n){var t=n.rect.clone();n.items&&n.items.length&&(r===u||r>u&&u>=1||(n.isTitle=!0,e._calculateItemRects(n.itemsRect,n.items,n.value,r+1,u)))})},t.prototype._renderHierarchicalTreeMapItems=function(n,r,u,f,e,o,s){var v=f.length,w=this.type,y,h,a,p,c,l;if(v!==0)for(l=0;l<v;l++)y=n.startGroup(t._CSS_ITEMDEPTH+o),h=f[l],a=Math.abs(h.value),p=h.rect,h.draw(n),c=new i._RectArea(p),h.items&&this._renderHierarchicalTreeMapItems(n,y,h.itemsRect,h.items,a,o+1,s),c.tag=this._itemIndex,c.name=h.label,c.value=a,c.item=h,this._areas.push(c),this._itemIndex++,n.endGroup()},t.prototype._renderLabels=function(n){var a=this._areas.length,u=this.dataLabel,l=u.position,v=u.connectingLine,y=u.border,f,e,s,t,h,o,c;for(l=i.LabelPosition.Center,n.stroke='null',n.fill='transparent',n.strokeWidth=1,n.startGroup('wj-data-labels'),e=0;e<a;e++)s=this._areas[e],s&&(t=s.rect,h=new i.HitTestInfo(this,f),h._setData(null,e),o=this._getLabelContent(h,u.content),f=new r.Point(t.left+t.width/2,t.top+t.height/2),o&&t.width>0&&t.height>0&&(c=new i.DataLabelRenderEventArgs(n,h,f,o),u.onRendering(c)&&(o=c.text,f=c.point,this._renderLabelAndBorder(n,s,t,o,l,0,f,v,2,y))));n.endGroup()},t.prototype._renderLabelAndBorder=function(n,t,r,u,f,e,o,s,h,c){var l,a='wj-data-label',v='wj-data-label-line';switch(f){case i.LabelPosition.Top:s&&n.drawLine(o.x,o.y,o.x,o.y-e,v);o.y-=h+e;l=this._renderText(n,t,r,u,o,1,2,a);break;case i.LabelPosition.Bottom:s&&n.drawLine(o.x,o.y,o.x,o.y+e,v);o.y+=h+e;l=this._renderText(n,t,r,u,o,1,0,a);break;case i.LabelPosition.Left:s&&n.drawLine(o.x,o.y,o.x-e,o.y,v);o.x-=h+e;l=this._renderText(n,t,r,u,o,2,1,a);break;case i.LabelPosition.Right:s&&n.drawLine(o.x,o.y,o.x+e,o.y,v);o.x+=h+e;l=this._renderText(n,t,r,u,o,0,1,a);break;case i.LabelPosition.Center:l=this._renderText(n,t,r,u,o,1,1,a)}return c&&l&&n.drawRect(l.left-h,l.top-h,l.width+2*h,l.height+2*h,'wj-data-label-border'),l},t.prototype._renderText=function(n,t,r,u,e,o,s,h){var l=u,c,a=t.item;return c=n.measureString(u,h),this.type===f.Horizontal&&a.isTitle?(c.width>r.height&&(l=this._cutText(u,c.width,r.height)),i.FlexChart._renderRotatedText(n,l,e,o,s,e,-90,h),null):(c.width>r.width&&(l=this._cutText(u,c.width,r.width)),i.FlexChart._renderText(n,l,e,o,s,h))},t.prototype._cutText=function(n,t,i){var r='',f=n.length,u=Math.floor((1-(t-i)/t)*f);return n.length>0&&(r=n[0]+(u>0?n.substring(1,u-1)+'..':'')),r},t.prototype._measureLegendItem=function(n,t){var u=new r.Size,f;return u.width=i.Series._LEGEND_ITEM_WIDTH,u.height=i.Series._LEGEND_ITEM_HEIGHT,t&&(f=n.measureString(t,i.FlexChart._CSS_LABEL,i.FlexChart._CSS_LEGEND),u.width+=f.width,u.height<f.height&&(u.height=f.height)),u.width+=3*i.Series._LEGEND_ITEM_MARGIN,u.height+=2*i.Series._LEGEND_ITEM_MARGIN,u},t.prototype._getDesiredLegendSize=function(n,t,i,u){var f=new r.Size,s=new r.Size(i,u),h=this._tmItems.length,i=0,u=0,o,e;for(this._colRowLens=[],o=0;o<h;o++)e=this._measureLegendItem(n,this._tmItems[o].label),t?(i<e.width&&(i=e.width),u+e.height>s.height&&(f.height=s.height,this._colRowLens.push(i),u=0,i=0),u+=e.height,o===h-1&&(f.height<u&&(f.height=u),this._colRowLens.push(i))):(u<e.height&&(u=e.height),i+e.width>s.width&&(f.width=s.width,this._colRowLens.push(u),u=0,i=0),i+=e.width,o===h-1&&(f.width<i&&(f.width=i),this._colRowLens.push(u)));return t?f.width=this._colRowLens.reduce(function(n,t){return n+t},0):f.height=this._colRowLens.reduce(function(n,t){return n+t},0),f},t.prototype._renderLegend=function(n,t,i,u){for(var e,l,o=this._rectLegend,a=this._tmItems.length,s=0,f=t.clone(),c,h=0;h<a;h++)c=this._tmItems[h].label,e=this._measureLegendItem(n,c),u?f.y+e.height>o.top+o.height+1&&(f.x+=this._colRowLens[s],s++,f.y=t.y):f.x+e.width>o.left+o.width+1&&(f.y+=this._colRowLens[s],s++,f.x=t.x),l=new r.Rect(f.x,f.y,e.width,e.height),this._drawLegendItem(n,l,h,c),i.push(l),u?f.y+=e.height:f.x+=e.width},t.prototype._drawLegendItem=function(n,t,u,f){n.strokeWidth=1;var s=i.Series._LEGEND_ITEM_MARGIN,e=this._getColor(u),h=e&&e.maxColor?e.maxColor:e,l=this._getLightColor(h);n.fill=h;n.stroke=l;var c=t.top+.5*t.height,a=i.Series._LEGEND_ITEM_WIDTH,o=i.Series._LEGEND_ITEM_HEIGHT;n.drawRect(t.left+s,c-.5*o,a,o,null);f&&i.FlexChart._renderText(n,f,new r.Point(t.left+o+2*s,c),0,1,i.FlexChart._CSS_LABEL)},t.prototype._getLabelContent=function(n,t){return r.isString(t)?this._keywords.replace(t,n):r.isFunction(t)?t(n):null},t.prototype.hitTest=function(n,t){var u=this._toControl(n,t),r=new i.HitTestInfo(this,u),f=null,a,e,c,s,l,o,h;if(i.FlexChart._contains(this._rectHeader,u))r._chartElement=i.ChartElement.Header;else if(i.FlexChart._contains(this._rectFooter,u))r._chartElement=i.ChartElement.Footer;else if(i.FlexChart._contains(this._rectLegend,u))r._chartElement=i.ChartElement.Legend,f=this.legend._hitTest(u),f!==null&&f>=0&&f<this._areas.length&&r._setData(null,f);else if(i.FlexChart._contains(this._rectChart,u)){for(a=this._areas.length,e=NaN,s=0;s<a;s++)l=u.clone(),o=this._areas[s],o.contains(l)&&(r._setData(null,o.tag),r._dist=0),h=o.distance(l),h!==undefined&&(isNaN(e)||h<e)&&(e=h,c=o);r._dist!==0&&c!=null&&(r._setData(null,c.tag),r._dist=e);r._chartElement=i.ChartElement.ChartArea}else r._chartElement=i.ChartElement.None;return r},t.prototype._getHitTestItem=function(n){var t=null,i=null;return t=this._cv!=null?this._cv.items:this.itemsSource,t&&n<t.length&&(i=t[n]),i},t.prototype._getHitTestValue=function(n){return this._values[n]},t.prototype._getHitTestLabel=function(n){return this._labels[n]},t}(i.FlexChartBase);o._CSS_ITEMDEPTH='wj-treemap-item-depth';o._MARGIN=0;t.TreeMap=o;h=function(){function n(){this.items=[];this.maxValue=Number.MIN_VALUE;this.minValue=Number.MAX_VALUE}return n.prototype.draw=function(t){var i=this.rect;t.strokeWidth=0;this.isTitle?(t.fill=this.titleFill,t.stroke=this.titleStroke):(t.fill=this.fill,t.stroke=this.stroke);t.drawRect(i.left,i.top,i.width,i.height,n._CLASSNAME)},Object.defineProperty(n.prototype,"itemsRect",{get:function(){var n=this.rect,t=this._rect,i=this.depth===1?2:.5;return this.isTitle?this.type===f.Horizontal?new r.Rect(n.left+n.width+1,n.top,t.width-n.width-i*2,n.height+1):new r.Rect(n.left,n.top+n.height+1,n.width+1,t.height-n.height-i*2):new r.Rect(0,0,0,0)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"rect",{get:function(){var u=this._rect,n=this.depth===1?2:.5,t=u.width,i=u.height,e=u.left,o=u.top;return this.isTitle?(this.type===f.Horizontal?(t=u.width>20?20:t,t=Math.max(20,t-2*n),i=i>n*2?i-n*2:0):(i=u.height>20?20:i,i=Math.max(20,i-2*n),t=t>n*2?t-n*2:0),e=e+n,o=o+n):(t=t>n*2?t-n*2:0,i=i>n*2?i-n*2:0),new r.Rect(e,o,t,i)},set:function(n){n!=this._rect&&(this._rect=n)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"isTitle",{get:function(){return this._isTitle},set:function(n){var t=r.asBoolean(n,!0);t!==this._isTitle&&(this._isTitle=t)},enumerable:!0,configurable:!0}),n}();h._CLASSNAME='wj-treemap-item';c=function(){function n(n,t,i,u,f,e){this.minColor=new r.Color(n);this.minColorValue=t;this.maxColor=new r.Color(i);this.maxColorValue=u;this.midColorValue=this.originalMidColorValue=e;this._calculateMidColorValue();this.midColor=this.originalMidColor=new r.Color(f);this._calculateMidColor()}return n.prototype._resetminColor=function(n){this.minColor=new r.Color(n);this._calculateMidColor()},n.prototype._resetmidColor=function(n){this.midColor=this.originalMidColor=new r.Color(n);this._calculateMidColor()},n.prototype._resetmaxColor=function(n){this.maxColor=new r.Color(n);this._calculateMidColor()},n.prototype._resetminColorValue=function(n){this.minColorValue=n;this._calculateMidColorValue()},n.prototype._resetmidColorValue=function(n){this.midColorValue=this.originalMidColorValue=n;this._calculateMidColorValue()},n.prototype._resetmaxColorValue=function(n){this.maxColorValue=n;this._calculateMidColorValue()},n.prototype._calculateMidColorValue=function(){this.originalMidColorValue==null&&(this.midColorValue=(this.maxColorValue+this.minColorValue)/2)},n.prototype._calculateMidColor=function(){this.originalMidColor==null&&(this.midColor=this._calculateColorByVal(this.midColorValue,!0))},n.prototype._calculateColorByVal=function(n,t){t===void 0&&(t=!1);var i=this.maxColor,u=this.minColor,f=this.maxColorValue,e=this.minColorValue;if(n>=this.maxColorValue)return new r.Color(i.toString());if(n<=this.minColorValue)return new r.Color(u.toString());if(!t){if(n===this.midColorValue)return new r.Color(this.midColor.toString());n<this.midColorValue?(i=this.midColor,f=this.midColorValue):(u=this.midColor,e=this.midColorValue)}return this._getColor(n,i,f,u,e)},n.prototype._getColor=function(n,t,i,u,f){return r.Color.fromRgba(this._getValueByRatio(n,t.r,i,u.r,f),this._getValueByRatio(n,t.g,i,u.g,f),this._getValueByRatio(n,t.b,i,u.b,f),this._getValueByRatio(n,t.a,i,u.a,f))},n.prototype._getValueByRatio=function(n,t,i,r,u){return Math.abs(r+Math.round((n-u)*(t-r)/(i-u)))},n}();s=function(){function n(){}return n.squarified=function(t,i,r){var f=t.slice(),u=i.clone(),o=u.width*u.height/r,e,s;do e=n.getRowedItems(f,u,o),s=n.layoutRowedItems(i,e,u,u.width>u.height);while(f.length)},n.horizontal=function(t,i,r){var u=i.clone();t.forEach(function(t){var f=[{item:t,val:t.value*i.width*i.height/r}],e=n.layoutRowedItems(i,f,u,!1)})},n.vertical=function(t,i,r){var u=i.clone();t.forEach(function(t){var f=[{item:t,val:t.value*i.width*i.height/r}],e=n.layoutRowedItems(i,f,u,!0)})},n.getNarrowLen=function(n){return Math.min(n.width,n.height)},n.getRowedItem=function(n,t,i){var r=i*n.value;return{item:n,val:r}},n.getRowedItems=function(t,i,r){var s=t.shift(),u=[],f=[],e=n.getNarrowLen(i),o=n.getRowedItem(s,i,r);if(u.push(o),f.push(o),t.length>0)do if(f.push(n.getRowedItem(t[0],i,r)),n.worst(u,e)>n.worst(f,e))u=f.slice(),t.shift();else break;while(t.length);return u},n.layoutRowedItems=function(t,i,u,f){var o=u.left,s=u.top,h=o+u.width,c=s+u.height,e,l=n.sumRowedArray(i);f?(e=u.height===0?0:l/u.height,o+e>=h&&(e=h-o),i.forEach(function(n,t){var u=e===0?0:n.val/e,f;(s+u>c||t===i.length-1)&&(u=c-s);f=new r.Rect(o,s,e,u);n.item.rect=f;s+=u}),u.left+=e,u.width-=e):(e=u.width===0?0:l/u.width,s+e>=c&&(e=c-s),i.forEach(function(n,t){var u=e===0?0:n.val/e,f;(o+u>h||t===i.length-1)&&(u=h-o);f=new r.Rect(o,s,u,e);n.item.rect=f;o+=u}),u.top+=e,u.height-=e)},n.sumRowedArray=function(n){for(var i=0,r=n.length,t=0;t<r;t++)i+=n[t].val;return i},n.worst=function(t,i){var r,u,f=n.sumRowedArray(t),e=f*f,o=i*i;return r=u=t[0].val,t.forEach(function(n){n.val>r?r=n.val:n.val<u&&(u=n.val)}),Math.max(o*r/e,e/(o*u))},n}();e=function(){function n(){}return n.parseDataToHierarchical=function(t,i,u,f){var e=[],o;return t instanceof r.CollectionView&&t.groups.length>0?e=n.parseGroupCV(t,i):t.length>0&&(r.isString(u)&&u.indexOf(',')>-1&&(u=u.split(',')),f?e=n.parseItems(t,i,u,f):(o=n.convertFlatData(t,i,u),e=n.parseItems(o,'value',u,'items'))),e},n.parseGroupCV=function(n,t){for(var u,r=[],i=0,f=n.groups.length;i<f;i++)u=this.parseGroups(n.groups[i],t),r.push(u);return r},n.parseGroups=function(n,t){var i={},u,f,e;if(i.name=n.name,i.nameField=n.groupDescription.propertyName,i.item=n.items,n.groups&&n.groups.length)for(i.items=[],u=0,f=n.groups.length;u<f;u++)e=this.parseGroups(n.groups[u],t),i.items.push(e);else n.isBottomLevel&&(i.value=n.getAggregate(r.Aggregate.Sum,t));return i},n.parseItems=function(t,i,r,u){for(var e=[],o=t.length,f=0;f<o;f++)e.push(n.parseItem(t[f],i,r,u));return e},n.isFlatItem=function(n,t){return r.isArray(n[t])?!1:!0},n.convertFlatData=function(t,i,u){for(var e=[],o={},s,h=t.length,f=0;f<h;f++)s=t[f],n.convertFlatItem(o,s,i,r.isArray(u)?u:[u]);return n.convertFlatToHierarchical(e,o),e},n.convertFlatToHierarchical=function(t,i){var r=i.flatDataOrder;r&&r.forEach(function(r){var u={},f=i[r],e;u[i.field]=r;f.flatDataOrder?(e=[],n.convertFlatToHierarchical(e,f),u.items=e):u.value=f;t.push(u)})},n.convertFlatItem=function(t,i,r,u){var e,o,f,s,h;return(e=u.slice(),o=e.shift().trim(),f=i[o],f==null)?!1:(e.length===0?(t[f]=i[r]||0,t.flatDataOrder?t.flatDataOrder.push(f):t.flatDataOrder=[f],t.field=o):(t[f]==null&&(t[f]={},t.flatDataOrder?t.flatDataOrder.push(f):t.flatDataOrder=[f],t.field=o),s=t[f],h=n.convertFlatItem(s,i,r,e),h||(t[f]=i[r])),!0)},n.parseItem=function(t,i,u,f){var e={},h,l,o,c,s;return r.isArray(f)?(s=f.slice(),c=s.length?s.shift().trim():''):(s=f,c=f),r.isArray(u)?(h=u.slice(),l=h.shift().trim(),e.nameField=l,e.name=t[l],o=t[c],h.length===0?e.value=t[i]:o&&r.isArray(o)&&o.length>0?e.items=n.parseItems(o,i,h,s):e.value=t[i]||0):(e.nameField=u,e.name=t[u],o=t[c],o!=null&&r.isArray(o)&&o.length>0?e.items=n.parseItems(o,i,u,s):e.value=t[i]),e.item=t,e},n.parseFlatItem=function(n){n.items||(n.items=[])},n}();t.HierarchicalUtil=e})